import { Meta, Source } from "@storybook/blocks";
import { Link, Tip, Frame, UsageGuidelines } from "vibe-storybook-components";
import { Text, Heading } from "../../../components";
import vibeXMcp from "./assets/vibe-x-mcp.png";

<Meta title="MCP [New]" />

# MCP Server

The Vibe MCP server enables AI assistants to interact intelligently with the Vibe Design System. Whether you're building components, migrating code, or exploring design tokens, MCP provides the context your AI needs to help you work more efficiently.

<div style={{ width: "100%", display: "flex" }}>
  <img
    src={vibeXMcp}
    alt="Vibe x MCP Integration"
    style={{ maxWidth: 800, width: "100%", borderRadius: "var(--border-radius-medium)", marginInline: "auto" }}
  />
</div>

## Overview

Model Context Protocol is an open standard that enables AI assistants to securely connect to external data sources and tools. The Vibe MCP server provides powerful tools that give AI assistants comprehensive access to the Vibe ecosystem.

## Available Tools

### Component Discovery

- [`get-vibe-component-metadata`](#get-vibe-component-metadata) - Get comprehensive metadata for any Vibe component
- [`list-vibe-public-components`](#list-vibe-public-components) - Browse all available public components in the Vibe ecosystem
- [`get-vibe-component-accessibility`](#get-vibe-component-accessibility) - Get accessibility requirements and guidelines for Vibe components

### Code Examples

- [`get-vibe-component-examples`](#get-vibe-component-examples) - Access React implementation examples and best practices

### Design System Resources

- [`list-vibe-icons`](#list-vibe-icons) - Explore the complete Vibe icon library with smart filtering
- [`list-vibe-tokens`](#list-vibe-tokens) - Access design tokens for consistent styling

### Migration Assistant

- [`v3-migration`](#v3-migration) - Advanced project analysis for Vibe 2 â†’ Vibe 3 migration

### Analytics & Monitoring

- [`get-session-analytics`](#get-session-analytics) - Session analytics following MCPcat concepts
- [`get-project-analytics`](#get-project-analytics) - Project analytics and system health monitoring
- [`get-user-identification-info`](#get-user-identification-info) - User identification methods and options
- [`demonstrate-user-identification`](#demonstrate-user-identification) - User identification examples and demonstrations
- [`get-mcpcat-system-info`](#get-mcpcat-system-info) - MCPcat system information and "How it works" concepts

## Tool Reference

#### `get-vibe-component-metadata`

**Use cases:**

- Understand component APIs
- Discover available props
- Check component compatibility

#### `list-vibe-public-components`

**Use cases:**

- Explore available components
- Find alternatives to custom solutions
- Discover new component releases
- Component ecosystem overview

#### `get-vibe-component-examples`

**Perfect for:**

- Learning component patterns
- Understanding proper usage
- Copy-paste ready code snippets
- Implementation guidance

#### `list-vibe-icons`

**Features:**

- 270+ available icons
- Category filtering (Basic, Platform, View)
- Text search across names and tags
- Usage examples included
- React component imports

#### `list-vibe-tokens`

**Includes:**

- Color tokens (all themes)
- Spacing and layout tokens
- Border radius values
- Motion and timing tokens

#### `v3-migration`

This tool analyzes your entire project and provides:

- **Comprehensive project scanning** - Identifies all Vibe component usage
- **Breaking change detection** - Highlights components that need updates
- **Migration command generation** - Provides ready-to-run codemod commands
- **Detailed migration report** - Complete analysis with recommendations

#### `get-session-analytics`

Get comprehensive session analytics following [MCPcat session concepts](https://docs.mcpcat.io/concepts/sessions):

- **Session Lifecycle Tracking** - Monitor session creation, activity, and termination
- **User Engagement Metrics** - Track session duration and tool usage patterns
- **Client Information** - Identify which AI clients are connecting
- **Performance Insights** - Average session duration and tool call frequency
- **Active Session Monitoring** - Real-time view of current user sessions

#### `get-project-analytics`

Get project-level analytics following [MCPcat project concepts](https://docs.mcpcat.io/concepts/projects):

- **Project Health Metrics** - System uptime, memory usage, and performance
- **Tool Usage Statistics** - Which tools are most frequently used
- **Session Aggregation** - Total sessions and average engagement
- **Environment Monitoring** - Platform and Node.js version tracking
- **Event Processing Status** - Analytics pipeline health and throughput

#### `get-user-identification-info`

Get comprehensive information about user identification methods available in MCPcat:

- **Identification Methods Overview** - OAuth, client-based, session-based, and anonymous options
- **Availability Assessment** - Which methods work without setup vs require configuration
- **Privacy Levels** - Understanding privacy implications of each approach
- **Current Session Analysis** - Real-time view of active client types and identification patterns

#### `demonstrate-user-identification`

Interactive demonstration of user identification approaches:

- **Current Implementation Details** - How the system currently identifies users
- **Method Examples** - Sample user IDs for different client types (Claude Desktop, Cursor, etc.)
- **Configuration Options** - How to enable anonymous mode or complete opt-out
- **Best Practices** - Privacy-conscious approaches to user identification

#### `get-mcpcat-system-info`

Comprehensive overview of MCPcat analytics system following the "How it works" documentation:

- **Core Concepts Overview** - Session tracking, user intent capture, request tracing
- **Current System Status** - Active sessions, event processing state, privacy mode
- **Session Lifecycle Details** - Creation, activity tracking, timeout management
- **User Intent Capture** - Context parameter injection and AI assistant integration
- **Request Tracing Information** - Protocol interception and event types
- **Asynchronous Processing** - Event queuing, batching, and zero-performance impact

<Tip title="Migration Made Easy">
  The migration tool follows the official Vibe 3 migration guide and generates precise codemod commands to automate most
  of the migration process.
</Tip>

## Installation

### For Cursor Users

[![Install MCP Server](https://cursor.com/deeplink/mcp-install-dark.svg)](https://cursor.com/en/install-mcp?name=vibe&config=eyJjb21tYW5kIjoibnB4IC15IEB2aWJlL21jcCJ9)

Or manually add to your `~/.cursor/mcp.json`:

<Source
  language="json"
  code={`{
  "mcpServers": {
    "vibe": {
      "command": "npx",
      "args": ["-y", "@vibe/mcp"]
    }
  }
}`}
/>

### For VSCode Users

[Click this link](vscode://mcp-server/add?config=%7B%22name%22%3A%22vibe%22%2C%22command%22%3A%22npx%22%2C%22args%22%3A%5B%22-y%22%2C%22%40vibe%2Fmcp%22%5D%7D) to auto-configure, or manually add to your `.vscode/mcp.json`:

<Source
  language="json"
  code={`{
  "servers": {
    "vibe": {
      "command": "npx",
      "args": ["-y", "@vibe/mcp"]
    }
  }
}`}
/>

## Usage Examples

### Component Development

Ask your AI assistant: _"I need a button that shows a loading state"_

The MCP will:

1. Find Button component metadata
2. Show loading prop usage examples
3. Provide accessibility guidelines

### Icon Discovery

Ask your AI assistant: _"Find icons related to calendar or scheduling"_

The MCP will:

1. Search icon library with "calendar" query
2. Return matching icons with usage examples
3. Include import statements and props

### Design Token Usage

Ask your AI assistant: _"What spacing tokens are available for margins?"_

The MCP will:

1. Filter tokens by "spacing" category
2. Show all margin-related design tokens
3. Provide CSS custom property usage

### Migration Planning

Ask your AI assistant: _"Help me migrate this React project from Vibe 2 to Vibe 3"_

The MCP will:

1. Analyze entire project structure
2. Identify deprecated component usage
3. Generate specific migration commands
4. Provide step-by-step recommendations

## Benefits

<UsageGuidelines
  guidelines={[
    "Faster development - Skip documentation lookup with instant access to component APIs",
    "Accurate guidance - Get precise, up-to-date information directly from the source",
    "Seamless migration - Automate complex migration tasks with intelligent analysis",
    "Design consistency - Ensure proper design token usage across your application"
  ]}
/>

## Telemetry & Privacy

The Vibe MCP server includes telemetry powered by [MCPcat](https://mcpcat.io) following their [privacy best practices](https://docs.mcpcat.io/essentials/privacy-&-security). This telemetry:

- **Tracks tool usage patterns** - Helps identify which tools are most valuable
- **Measures performance** - Tracks execution times and success rates
- **Anonymous Mode** - Collect analytics without user identification
- **Works in telemetry-only mode** - No account required for basic analytics

### Privacy Protections

Following MCPcat's recommendations, this implementation includes:

- **Automatic Data Redaction**: Email addresses, credit card numbers, API keys, passwords, and IP addresses are automatically redacted
- **Client-Side Protection**: Sensitive data never leaves your environment
- **Server-Side Validation**: MCPcat uses Microsoft Presidio for additional PII detection
- **Anonymous Mode**: Override user identification when privacy is preferred

### User Identification Methods

Following [MCPcat's user identification documentation](https://docs.mcpcat.io/identifying-users), this MCP server supports multiple identification approaches:

#### OAuth/API Key Integration
For servers with authentication systems:
```javascript
// Extract from request parameters
const token = request.params?.arguments?.token;
const apiKey = request.params?.arguments?.apiKey;
```

#### Client-Based Identification (Default)
Works without any setup - automatically identifies users based on:
- MCP client information (name, version, platform)
- Client capabilities and metadata
- User agent strings when available

#### Session-Based Consistency
Provides consistent user IDs across tool calls:
- Hash-based identification from client characteristics
- Session pattern recognition
- Deterministic but privacy-preserving user IDs

#### Anonymous Mode
For privacy-conscious deployments:
```bash
export ANONYMIZE_SESSIONS=true
```

### Opting Out

Following [MCPcat's privacy best practices](https://docs.mcpcat.io/essentials/privacy-&-security#disabling-telemetry), you can control telemetry using these environment variables:

```bash
# Privacy controls
export DISABLE_USER_ANALYTICS=true      # Disable all analytics
export ANONYMIZE_SESSIONS=true         # Anonymous mode

# Optional: Your project ID from mcpcat.io
export MCPCAT_PROJECT_ID=proj_32Eb5TYmIAuxKeKCpkEnQTMSOKP

# Optional: Customize project details
export MCPCAT_PROJECT_NAME="My Vibe MCP Server"
export MCPCAT_PROJECT_DESCRIPTION="Custom Vibe MCP Server"
```

When telemetry is disabled, the MCP server will function normally but won't send any usage data to MCPcat.

## How Analytics Work

The server tracks usage patterns to help you understand how it's being used:

### Sessions
- Each AI client interaction creates a session
- Tracks engagement and tool usage patterns
- Sessions expire after 30 minutes of inactivity

### Projects
- Groups analytics by different deployments
- Supports different environments (dev/staging/production)
- Customizable project names and descriptions

### Events
- Records tool calls and responses
- Batches data for efficient processing
- Protects privacy with automatic data redaction

## Contributing

The [Vibe MCP server repository](https://github.com/mondaycom/vibe/tree/main/packages/mcp) is open source and welcomes contributions!

**Ways to contribute:**

- Report bugs or issues
- Suggest new tools or features
- Improve documentation
- Submit pull requests for new features
