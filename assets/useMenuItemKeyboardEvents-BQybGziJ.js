import{c as me}from"./index-BpvXyOxN.js";import{r as l,R as C}from"./index-Hemj67b4.js";import{u as fe}from"./useMergeRef-DQ4XPFxl.js";import{u as O}from"./useIsomorphicLayoutEffect-FdvxY73P.js";import{u as pe}from"./index-NFRdg0hY.js";import{u as I}from"./index-8zVcErkr.js";import{k as v}from"./function-utils-6EQ2u6TA.js";import{N as K,b as be,A as ye,E as _e,H as Me,d as ve}from"./useFullKeyboardListeners-CpRGyrUm.js";import{u as w}from"./index-CXrJR90Q.js";import{g as ge}from"./typesciptCssModulesHelper-Ji7rRrZn.js";import{g as Ee,b as Ie}from"./test-ids-utils-9ISiqDto.js";import{w as Ve}from"./withStaticProps-DfSG2La2.js";import{S as ae}from"./sizes-BOsbvv4u.js";import{u as te}from"./index-DLqmmtYJ.js";function ke(){const[e,t]=l.useState(null),a=typeof e=="number",u=l.useCallback((r,c)=>{t(c?r:null)},[t]),n=l.useCallback(()=>{t(null)},[t]);return{setSubMenuIsOpenByIndex:u,hasOpenSubMenu:a,openSubMenuIndex:e,setOpenSubMenuIndex:t,resetOpenSubMenuIndex:n}}function H({setActiveItemIndex:e,setOpenSubMenuIndex:t,onClose:a}){return l.useCallback((u={propagate:!1})=>{e(-1),t(null),a&&a(u)},[a,t,e])}try{H.displayName="useOnCloseMenu",H.__docgenInfo={description:"",displayName:"useOnCloseMenu",props:{setActiveItemIndex:{defaultValue:null,description:"",name:"setActiveItemIndex",required:!0,type:{name:"(index: number) => void"}},setOpenSubMenuIndex:{defaultValue:null,description:"",name:"setOpenSubMenuIndex",required:!0,type:{name:"(index: number) => void"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"(option: CloseMenuOption) => void"}}}}}catch{}const qe=[v.ESCAPE,v.LEFT_ARROW,v.TAB];function L({hasOpenSubMenu:e,onCloseMenu:t,ref:a,onClose:u,isSubMenu:n,useDocumentEventListeners:r}){const c=l.useCallback(o=>{const s=o.key;e||s===v.LEFT_ARROW&&!n||[v.ESCAPE,v.LEFT_ARROW,v.TAB].includes(s)&&(t({propagate:!1}),u&&(u({propagate:!1},s),o.preventDefault(),o.stopPropagation()))},[u,e,t,n]);I({keys:qe,callback:c,ref:r?void 0:a})}try{L.displayName="useCloseMenuOnKeyEvent",L.__docgenInfo={description:"",displayName:"useCloseMenuOnKeyEvent",props:{hasOpenSubMenu:{defaultValue:null,description:"",name:"hasOpenSubMenu",required:!0,type:{name:"boolean"}},onCloseMenu:{defaultValue:null,description:"",name:"onCloseMenu",required:!0,type:{name:"(option: CloseMenuOption) => void"}},ref:{defaultValue:null,description:"",name:"ref",required:!0,type:{name:"RefObject<HTMLElement>"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"(option: CloseMenuOption, key?: string) => void"}},isSubMenu:{defaultValue:null,description:"",name:"isSubMenu",required:!0,type:{name:"boolean"}},useDocumentEventListeners:{defaultValue:null,description:"",name:"useDocumentEventListeners",required:!0,type:{name:"boolean"}}}}}catch{}function j({hasOpenSubMenu:e,getNextSelectableIndex:t,getPreviousSelectableIndex:a,activeItemIndex:u,setActiveItemIndex:n,isVisible:r,ref:c,useDocumentEventListeners:o}){const s=l.useCallback(b=>{let _;if(e)return!1;b===K.DOWN?_=t(u):b===K.UP&&(_=a(u)),(_||_===0)&&n(_)},[u,t,a,e,n]),d=l.useCallback(()=>{s(K.UP)},[s]),p=l.useCallback(()=>{s(K.DOWN)},[s]),g=l.useCallback(b=>{r&&u===-1&&n(0)},[n,u,r]),y=l.useCallback(()=>{if(e)return;const b=t(-1);b!==-1&&n(b)},[e,t,n]),E=l.useCallback(()=>{if(e)return;const b=a(0);b!==-1&&n(b)},[e,a,n]),m=l.useMemo(()=>{if(!o)return{ref:c,preventDefault:!0,stopPropagation:!0}},[o,c]);I({keys:be,callback:p,...m}),I({keys:ye,callback:d,...m}),I({keys:_e,callback:g,...m}),I({keys:Me,callback:y,...m}),I({keys:ve,callback:E,...m})}try{j.displayName="useMenuKeyboardNavigation",j.__docgenInfo={description:"",displayName:"useMenuKeyboardNavigation",props:{hasOpenSubMenu:{defaultValue:null,description:"",name:"hasOpenSubMenu",required:!0,type:{name:"boolean"}},getNextSelectableIndex:{defaultValue:null,description:"",name:"getNextSelectableIndex",required:!0,type:{name:"(index: number) => number"}},getPreviousSelectableIndex:{defaultValue:null,description:"",name:"getPreviousSelectableIndex",required:!0,type:{name:"(index: number) => number"}},activeItemIndex:{defaultValue:null,description:"",name:"activeItemIndex",required:!0,type:{name:"number"}},setActiveItemIndex:{defaultValue:null,description:"",name:"setActiveItemIndex",required:!0,type:{name:"(index: number) => void"}},isVisible:{defaultValue:null,description:"",name:"isVisible",required:!0,type:{name:"boolean"}},ref:{defaultValue:null,description:"",name:"ref",required:!0,type:{name:"RefObject<HTMLElement>"}},useDocumentEventListeners:{defaultValue:null,description:"",name:"useDocumentEventListeners",required:!0,type:{name:"boolean"}}}}}catch{}function P({ref:e}){const[t,a]=l.useState(!1),u=l.useCallback(r=>{const c=e&&e.current,o=r.target===c;a(o)},[a,e]),n=l.useCallback(()=>a(!1),[a]);return te({eventName:"mouseenter",callback:u,ref:e}),te({eventName:"mouseleave",callback:n,ref:e}),t}function U({resetOpenSubMenuIndex:e,hasOpenSubMenu:t,ref:a,setActiveItemIndex:u}){const n=P({ref:a}),r=w(n);return O(()=>{n||n!==r&&(t||(e(),u(-1)))},[e,a,r,n,t,u]),n}try{U.displayName="useMouseLeave",U.__docgenInfo={description:"",displayName:"useMouseLeave",props:{resetOpenSubMenuIndex:{defaultValue:null,description:"",name:"resetOpenSubMenuIndex",required:!0,type:{name:"() => void"}},hasOpenSubMenu:{defaultValue:null,description:"",name:"hasOpenSubMenu",required:!0,type:{name:"boolean"}},ref:{defaultValue:null,description:"",name:"ref",required:!0,type:{name:"RefObject<HTMLElement>"}},setActiveItemIndex:{defaultValue:null,description:"",name:"setActiveItemIndex",required:!0,type:{name:"(index: number) => void"}}}}}catch{}function Y(e){return!!e.type.isSelectable&&!e.props.disabled}const Ce=(e,t,a)=>t.props.id||`${e}-item-${a}`,$=({children:e})=>{const t=l.useCallback(u=>{let n;for(let r=1;r<=e.length;r++)if(n=(u+r)%e.length,Y(e[n]))return n;return null},[e]),a=l.useCallback(u=>{let n;for(let r=e.length-1;r>0;r--)if(n=(u+r)%e.length,Y(e[n]))return n;return null},[e]);return{getNextSelectableIndex:t,getPreviousSelectableIndex:a}};try{$.displayName="useAdjacentSelectableMenuIndex",$.__docgenInfo={description:"",displayName:"useAdjacentSelectableMenuIndex",props:{}}}catch{}function Se({onFocusWithin:e,onFocusWithinChange:t,isDisabled:a,onBlurWithin:u}){const n=l.useRef({isFocusWithin:!1}).current,r=l.useCallback(s=>{n.isFocusWithin||(e&&e(s),t&&t(!0),n.isFocusWithin=!0)},[e,t,n]),c=l.useCallback(s=>{const d=s.currentTarget;n.isFocusWithin&&!d.contains(s.relatedTarget)&&(u&&u(s),t&&t(!1),n.isFocusWithin=!1)},[u,t,n]),o=l.useMemo(()=>a?{focusWithinProps:{}}:{},[a]);return a?o:{focusWithinProps:{onFocus:r,onBlur:c}}}const W=({focusItemIndexOnMount:e,focusChildOnMount:t,getNextSelectableIndex:a,updateActiveItemIndex:u,setIsInitialFocusSet:n})=>{l.useEffect(()=>{if(e===-1)return;const r=Y(t)?e:a(e);r!==null&&requestAnimationFrame(()=>{u(r),n(!0)})},[t,e,a,n,u])};try{W.displayName="useFocusOnMount",W.__docgenInfo={description:"",displayName:"useFocusOnMount",props:{focusItemIndexOnMount:{defaultValue:null,description:"",name:"focusItemIndexOnMount",required:!0,type:{name:"number"}},focusChildOnMount:{defaultValue:null,description:"",name:"focusChildOnMount",required:!0,type:{name:"ReactElement<any, string | JSXElementConstructor<any>>"}},getNextSelectableIndex:{defaultValue:null,description:"",name:"getNextSelectableIndex",required:!0,type:{name:"(index: number) => number"}},updateActiveItemIndex:{defaultValue:null,description:"",name:"updateActiveItemIndex",required:!0,type:{name:"(index: number) => void"}},setIsInitialFocusSet:{defaultValue:null,description:"",name:"setIsInitialFocusSet",required:!0,type:{name:"(state: boolean) => void"}}}}}catch{}let Ne=0;const Oe=()=>`menu-${Ne++}`,z=e=>{const[t,a]=l.useState();return O(()=>{a(e||Oe())},[e]),t};try{z.displayName="useMenuId",z.__docgenInfo={description:"",displayName:"useMenuId",props:{}}}catch{}const Re="_menu_10tj4_1",Ae="_small_10tj4_11",he="_medium_10tj4_15",Te="_large_10tj4_19",ne={menu:Re,small:Ae,medium:he,large:Te},x=l.forwardRef(({id:e,className:t,size:a=ae.MEDIUM,tabIndex:u=0,ariaLabel:n="Menu",ariaDescribedBy:r,children:c,isVisible:o=!0,onClose:s,onItemFocus:d,focusOnMount:p=!1,focusItemIndex:g=-1,focusItemIndexOnMount:y=-1,isSubMenu:E=!1,useDocumentEventListeners:m=!1,shouldScrollMenu:b=!1,"data-testid":_},S)=>{const i=l.useRef(null),ue=fe(i,S),R=z(e),re=l.useRef(null),[A,le]=l.useState(g),[se,h]=l.useState(!1),V=l.useMemo(()=>C.Children.toArray(c).filter(M=>M.type.isMenuChild?!0:(console.error("Menu child must be a menuChild item (such as MenuItem, MenuDivider, MenuTitle, etc). This child is not supported: ",M),!1)),[c]),T=l.useCallback(f=>{var Q,B,ee;le(f);const M=V[f],Z=C.isValidElement(M)?((Q=M==null?void 0:M.props)==null?void 0:Q.id)||`${R}-item-${f}`:void 0;Z?(B=i==null?void 0:i.current)==null||B.setAttribute("aria-activedescendant",Z):(ee=i==null?void 0:i.current)==null||ee.removeAttribute("aria-activedescendant")},[V,R]),F=l.useCallback(f=>{d&&d(f),T(f),h(!1)},[T,d]),{setSubMenuIsOpenByIndex:oe,hasOpenSubMenu:k,openSubMenuIndex:ie,setOpenSubMenuIndex:ce,resetOpenSubMenuIndex:G}=ke(),N=H({setActiveItemIndex:F,setOpenSubMenuIndex:ce,onClose:s});pe({ref:i,callback:()=>N()}),L({hasOpenSubMenu:k,onCloseMenu:N,ref:i,onClose:s,isSubMenu:E,useDocumentEventListeners:m});const{getNextSelectableIndex:D,getPreviousSelectableIndex:J}=$({children:V});j({hasOpenSubMenu:k,getNextSelectableIndex:D,getPreviousSelectableIndex:J,activeItemIndex:A,setActiveItemIndex:F,isVisible:o,ref:i,useDocumentEventListeners:m}),U({resetOpenSubMenuIndex:G,hasOpenSubMenu:k,ref:i,setActiveItemIndex:F}),W({focusItemIndexOnMount:y,focusChildOnMount:V[y],getNextSelectableIndex:D,updateActiveItemIndex:T,setIsInitialFocusSet:h});const de=l.useCallback(()=>{h(!0)},[h]),X=w(k);l.useEffect(()=>{var f;k||m||A>-1&&X&&((f=i==null?void 0:i.current)==null||f.focus())},[A,k,X,m]),O(()=>{!p||m||requestAnimationFrame(()=>{i&&i.current&&i.current.focus()})},[i,p,m]);const{focusWithinProps:q}=Se({onBlurWithin:()=>{N&&N()}});return C.createElement("ul",{onFocus:q==null?void 0:q.onFocus,onBlur:q==null?void 0:q.onBlur,id:R,"data-testid":_||Ee(Ie.MENU,e),className:me(ne.menu,ge(ne,a),t),ref:ue,tabIndex:u,"aria-label":n,role:"menu","aria-describedby":r,onMouseOver:de},V&&C.Children.map(V,(f,M)=>C.isValidElement(f)?C.cloneElement(f,{...f==null?void 0:f.props,activeItemIndex:A,index:M,setActiveItemIndex:T,menuRef:i,resetOpenSubMenuIndex:G,isParentMenuVisible:o,setSubMenuIsOpenByIndex:oe,hasOpenSubMenu:M===ie,closeMenu:N,id:Ce(R,f,M),useDocumentEventListeners:m,isInitialSelectedState:se,shouldScrollMenu:b,getNextSelectableIndex:D,getPreviousSelectableIndex:J,isUnderSubMenu:E,splitMenuItemIconButtonRef:re}):null))});Object.assign(x,{isMenu:!0,supportFocusOnMount:!0});const Je=Ve(x,{sizes:ae});try{x.displayName="Menu",x.__docgenInfo={description:"",displayName:"Menu",props:{size:{defaultValue:{value:"medium"},description:"Size of the menu.",name:"size",required:!1,type:{name:"enum",value:[{value:'"small"'},{value:'"xs"'},{value:'"medium"'},{value:'"large"'},{value:'"xxs"'}]}},tabIndex:{defaultValue:{value:"0"},description:"The tab index of the menu.",name:"tabIndex",required:!1,type:{name:"number"}},ariaLabel:{defaultValue:{value:"Menu"},description:"ARIA label for accessibility.",name:"ariaLabel",required:!1,type:{name:"string"}},ariaDescribedBy:{defaultValue:null,description:"ARIA description ID.",name:"ariaDescribedBy",required:!1,type:{name:"string"}},focusOnMount:{defaultValue:{value:"false"},description:"If true, the menu will automatically focus on mount.",name:"focusOnMount",required:!1,type:{name:"boolean"}},onItemFocus:{defaultValue:null,description:"Callback when a menu item gains focus.",name:"onItemFocus",required:!1,type:{name:"(index: number) => void"}},isVisible:{defaultValue:{value:"true"},description:"Controls the visibility of the menu.",name:"isVisible",required:!1,type:{name:"boolean"}},onClose:{defaultValue:null,description:"Callback triggered when the menu closes.",name:"onClose",required:!1,type:{name:"(option: CloseMenuOption) => void"}},focusItemIndex:{defaultValue:{value:"-1"},description:"Index of the focused menu item.",name:"focusItemIndex",required:!1,type:{name:"number"}},isSubMenu:{defaultValue:{value:"false"},description:"If true, this menu is a submenu.",name:"isSubMenu",required:!1,type:{name:"boolean"}},useDocumentEventListeners:{defaultValue:{value:"false"},description:"If true, event listeners will be attached to the document.",name:"useDocumentEventListeners",required:!1,type:{name:"boolean"}},focusItemIndexOnMount:{defaultValue:{value:"-1"},description:"Index of the item that should be focused when the menu mounts.",name:"focusItemIndexOnMount",required:!1,type:{name:"number"}},shouldScrollMenu:{defaultValue:{value:"false"},description:"If true, enables scrolling within the menu.",name:"shouldScrollMenu",required:!1,type:{name:"boolean"}},children:{defaultValue:null,description:"The menu items.",name:"children",required:!1,type:{name:"ElementContent"}},className:{defaultValue:null,description:"A CSS class name to apply to the component.",name:"className",required:!1,type:{name:"string"}},"data-testid":{defaultValue:null,description:"A unique identifier for testing purposes.",name:"data-testid",required:!1,type:{name:"string"}},id:{defaultValue:null,description:"An HTML id attribute for the component.",name:"id",required:!1,type:{name:"string"}}}}}catch{}function Xe({ref:e,resetOpenSubMenuIndex:t,setSubMenuIsOpenByIndex:a,isActive:u,setActiveItemIndex:n,index:r,hasChildren:c,splitMenuItemIconButtonRef:o,splitMenuItem:s=!1}){const d=P({ref:e}),p=P({ref:o}),g=w(d),y=w(p);return O(()=>{p&&p!==y&&(u?a(r,!0):t())},[a,r,p,y,u,t]),O(()=>{if(d&&d!==g){if(!a||!t){console.error("MenuItem must be a first level child of a menu");return}t(),!u&&!s&&(n(r),c?a(r,!0):t()),u&&c&&a(r,!!d),!u&&s&&(n(r),p&&a(r,!0))}},[t,g,d,p,a,u,n,r,c,s]),d}const Ke=[v.ENTER,v.RIGHT_ARROW];function Ze({onClick:e,disabled:t,isActive:a,index:u,setActiveItemIndex:n,hasChildren:r,shouldShowSubMenu:c,setSubMenuIsOpenByIndex:o,menuRef:s,isMouseEnter:d,closeMenu:p,useDocumentEventListeners:g,splitMenuItem:y,isMouseEnterMenuItem:E,isMouseEnterIconButton:m}){const b=l.useCallback(_=>{if(!a&&!d)return;if(!n||!o){console.error("MenuItem must be a first level child of a menu");return}const S=_ instanceof KeyboardEvent;if(a&&r&&(n(u),!y||m)){o(u,!0);return}if(S&&y&&o(u,!0),c)return;const i=()=>{_.preventDefault(),e(_),p({propagate:!0})};if(S&&e&&!t&&a){if(_.key==="ArrowRight")return;i()}!S&&e&&!t&&d&&(a||(n(u),r&&o(u,!0)),(y&&E&&!m||!r)&&requestAnimationFrame(()=>{requestAnimationFrame(()=>{i()})}))},[a,d,n,o,r,y,c,e,t,u,p,E,m]);return I({keys:Ke,callback:b,ref:g?void 0:s}),{onClickCallback:b}}export{Je as M,Ze as a,Se as b,P as c,Xe as u};
