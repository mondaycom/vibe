import{r as f}from"./index-CTZeEbLr.js";import{u as g}from"./index-gB5zY9qh.js";import{u as M}from"./index-CkU0kzyk.js";import{u as K}from"./index-BxdhJjph.js";import{u as T}from"./index-BlWfPOxY.js";function y({isItemSelectable:r,visualFocusItemIndex:c,itemsCount:n}){if(!(c>n-1))for(let o=1;o<=n;o++){const a=(c+o)%n;if(r(a))return a}}function E({isItemSelectable:r,visualFocusItemIndex:c,itemsCount:n}){for(let o=1;o<=n-1;o++){let a=c-o;if(a<0&&(a=n+a),r(a))return a}}const h="Enter",U=" ";function X({itemsCount:r,focusedElementRef:c,visualFocusItemIndex:n,setVisualFocusItemIndex:o,isHorizontalList:a,isItemSelectable:t,listenerOptions:k,triggeredByKeyboard:i}){const p=a?"ArrowRight":"ArrowDown",s=a?"ArrowLeft":"ArrowUp",C=f.useCallback(b=>{if(document.activeElement!==c.current||!i.current&&(i.current=!0,n>-1))return;let O;b===p?O=y({isItemSelectable:t,visualFocusItemIndex:n,itemsCount:r}):b===s&&(O=E({isItemSelectable:t,visualFocusItemIndex:n,itemsCount:r})),O>-1&&O!==n&&o(O)},[c,i,p,s,n,o,t,r]),l=f.useCallback(()=>{C(s)},[s,C]),u=f.useCallback(()=>{C(p)},[p,C]);g({keys:[p],callback:u,...k}),g({keys:[s],callback:l,...k})}function Y({visualFocusItemIndex:r,focusedElementRef:c,itemsCount:n,setVisualFocusItemIndex:o,onItemClick:a,isItemSelectable:t,listenerOptions:k=void 0,isIgnoreSpaceAsItemSelection:i=!1}){const p=f.useMemo(()=>i?[h]:[h,U],[i]),s=f.useCallback((l,u)=>{const b=u>=0&&u<n;!a||!b||!t(u)||(r!==u&&o(u),a(l,u))},[n,a,t,r,o]),C=f.useCallback(l=>{c.current.contains(document.activeElement)&&s(l,r)},[s,c,r]);g({keys:p,callback:C,...k})}function _({focusedElementRef:r,visualFocusItemIndex:c,setVisualFocusItemIndex:n}){const o=K(r),a=f.useCallback(()=>{c!==-1&&n(-1)},[n,c]);f.useEffect(()=>{(r==null?void 0:r.current)===null&&(o==null?void 0:o.current)!==null&&a()},[r.current,o,a]),M({eventName:"blur",ref:r,callback:a})}function D({focusedElementRef:r,isItemSelectable:c,visualFocusItemIndex:n,setVisualFocusItemIndex:o,itemsCount:a,defaultVisualFocusItemIndex:t=-1}){const k=f.useRef(!1),i=f.useCallback(()=>{if(k.current=!0,n!==t){let s;c(t)?s=t:s=y({isItemSelectable:c,itemsCount:a,visualFocusItemIndex:t}),o(s)}},[t,c,a,o,k,n]),p=f.useCallback(()=>{k.current=!1},[k]);return T({ref:r,onFocusByKeyboard:i,onFocusByMouse:p}),{triggeredByKeyboard:k}}function G({visualFocusItemIndex:r,itemsIds:c,isItemSelectable:n,setVisualFocusItemIndex:o}){const a=K(c);f.useEffect(()=>{let t;if(a!==void 0&&a!==c&&a!==void 0&&r!==-1){const i=a[r];t=c.indexOf(i)}else t=r;if(t!==r)if(n(t))o(t);else{const i=y({isItemSelectable:n,visualFocusItemIndex:t,itemsCount:c.length});o(i)}},[r,c,n,o,a])}var B=(r=>(r.APPLICATION="application",r.COMBOBOX="combobox",r.COMPOSITE="composite",r.GROUP="group",r.TEXTBOX="textbox",r.MENU="menu",r))(B||{});function W({focusedElementRef:r,itemsIds:c,isItemSelectable:n,onItemClick:o,defaultVisualFocusFirstIndex:a=!1,focusedElementRole:t="group",isHorizontalList:k=!1,isIgnoreSpaceAsItemSelection:i=!1,useDocumentEventListeners:p=!1,ignoreDocumentFallback:s=!1}){const C=a?0:-1,l=c.length,[u,b]=f.useState(-1),O=c[u],P=f.useMemo(()=>p?s?{ignoreDocumentFallback:s}:void 0:{ref:r,preventDefault:!0,stopPropagation:!0},[p,r,s]),{triggeredByKeyboard:e}=D({focusedElementRef:r,isItemSelectable:n,visualFocusItemIndex:u,setVisualFocusItemIndex:b,itemsCount:l,defaultVisualFocusItemIndex:C}),N=f.useCallback((v,w)=>{e.current=w;const A=c.indexOf(v);A>-1&&A!==u&&b(A)},[c,e,u]);X({itemsCount:l,focusedElementRef:r,visualFocusItemIndex:u,setVisualFocusItemIndex:b,triggeredByKeyboard:e,isHorizontalList:k,isItemSelectable:n,listenerOptions:P}),Y({visualFocusItemIndex:u,itemsCount:l,focusedElementRef:r,setVisualFocusItemIndex:b,onItemClick:o,isItemSelectable:n,listenerOptions:P,isIgnoreSpaceAsItemSelection:i}),G({visualFocusItemIndex:u,itemsIds:c,isItemSelectable:n,setVisualFocusItemIndex:b}),_({focusedElementRef:r,visualFocusItemIndex:u,setVisualFocusItemIndex:b});const L=f.useCallback(v=>w=>o(w,v),[o]);return{visualFocusItemIndex:e.current?u:void 0,visualFocusItemId:e.current?O:void 0,focusedElementProps:{"aria-activedescendant":e.current?O:void 0,role:t},onItemClickCallback:o,createOnItemClickCallback:L,setVisualFocusItemId:N}}W.roles=B;export{W as u};
