import{r as l,R as J}from"./index-CTZeEbLr.js";import{u as _}from"./index-DEnqPy1V.js";import{A as V,N as r,a as q,b as G,c as H,u as j}from"./useFullKeyboardListeners-BKDHN2eU.js";import{u as z}from"./index-nBaTNWgC.js";const Q=[...V,...q,...G,...H],K=()=>{const t=l.useRef(document),e=l.useRef(),n=l.useCallback(o=>{e.current=o},[]),a=l.useCallback(({key:o})=>{V.includes(o)?n(r.UP):q.includes(o)?n(r.RIGHT):G.includes(o)?n(r.DOWN):H.includes(o)&&n(r.LEFT)},[n]),c=l.useCallback(()=>{e.current=void 0},[e]);return z({ref:t,capture:!0,keys:Q,callback:a}),_({eventName:"mousedown",ref:t,capture:!0,callback:c}),{lastNavigationDirectionRef:e}};function Z(t,e){const{topElement:n,bottomElement:a,leftElement:c,rightElement:o}=e;n&&a&&(t[r.UP].get(n)===a&&i("BOTTOM","TOP"),t[r.DOWN].get(a)===n&&i("TOP","BOTTOM")),c&&o&&(t[r.LEFT].get(c)===o&&i("RIGHT","LEFT"),t[r.RIGHT].get(o)===c&&i("LEFT","RIGHT"));function i(f,u){throw new Error(`Circular positioning detected: the ${f} element is already positioned to the ${u} of the ${u} element. This probably means the layout isn't ordered correctly.`)}}const O=t=>{const e={[r.RIGHT]:new Map,[r.LEFT]:new Map,[r.UP]:new Map,[r.DOWN]:new Map};return t.forEach(n=>{Z(e,n);const{topElement:a,bottomElement:c,leftElement:o,rightElement:i}=n;a&&c&&(e[r.UP].set(c,a),e[r.DOWN].set(a,c)),o&&i&&(e[r.LEFT].set(i,o),e[r.RIGHT].set(o,i))}),e},A=t=>{switch(t){case r.LEFT:return r.RIGHT;case r.RIGHT:return r.LEFT;case r.UP:return r.DOWN;case r.DOWN:return r.UP;default:throw new Error(`Unexpected direction: ${t}`)}},R=(t,e)=>{const n=t[e],a=[...n][0];if(!a)return[r.LEFT,r.RIGHT].includes(e)?R(t,r.UP):R(t,r.LEFT);const c=a[0];return ee(n,c)},M=(t,e)=>{var a;const n=t.get(e);return n?!n.current||n.current.disabled||((a=n.current.dataset)==null?void 0:a.disabled)==="true"?M(t,n):n:null};function ee(t,e){let n=!1,a=e;for(;!n;){const c=M(t,a);c?a=c:n=!0}return a}try{O.displayName="getDirectionMaps",O.__docgenInfo={description:"",displayName:"getDirectionMaps",props:{}}}catch{}try{A.displayName="getOppositeDirection",A.__docgenInfo={description:"",displayName:"getOppositeDirection",props:{}}}catch{}const S=J.createContext(null),oe=(t,e,n={disabled:!1})=>{const a=l.useMemo(()=>O(t),[t]),c=l.useContext(S),{lastNavigationDirectionRef:o}=K(),i=l.useCallback(()=>{var v;const u=o.current;if(!u||n.disabled)return;const s=A(u),m=R(a,s);(v=m==null?void 0:m.current)==null||v.focus()},[a,n.disabled,o]);return _({eventName:"focus",callback:i,ref:e}),{onOutboundNavigation:l.useCallback((u,s)=>{var v,E;if(n.disabled)return;const m=M(a[s],u);if(m){(v=u.current)==null||v.blur(),(E=m.current)==null||E.focus();return}c==null||c.onOutboundNavigation(e,s)},[a,c,e,n.disabled])}};function w({direction:t,numberOfItemsInLine:e,itemsCount:n}){const c=(()=>{const o=Math.floor(e/2);if(t===r.UP)return(Math.ceil(n/e)-1)*e+o;if(t===r.DOWN)return o;if(t===r.LEFT){let i=e-1;const f=Math.floor((n-1)/2);for(;i<f;)i+=e;return i}if(t===r.RIGHT){let i=0;const f=Math.floor((n-1)/2);for(;i+e<f;)i+=e;return i}})();return Math.max(0,Math.min(c,n-1))}function F({activeIndex:t,itemsCount:e,numberOfItemsInLine:n,direction:a,circularNavigation:c=!1}){const o=u=>Math.ceil((u+1)/n),i=u=>{let s=t+(u?1:-1);if(s<0||s>=e)if(c)s<0?s=e-1:s>=e&&(s=0);else return{isOutbound:!0};const m=o(t),v=o(s);return m!==v?{isOutbound:!0}:{isOutbound:!1,nextIndex:s}},f=u=>{const s=t+n*(u?1:-1);return s<0||e<=s?{isOutbound:!0}:{isOutbound:!1,nextIndex:s}};switch(a){case r.RIGHT:return i(!0);case r.LEFT:return i(!1);case r.DOWN:return f(!0);case r.UP:return f(!1)}}function D({activeIndex:t,itemsCount:e,numberOfItemsInLine:n,direction:a,disabledIndexes:c=[],circularNavigation:o=!1}){let i=F({activeIndex:t,itemsCount:e,numberOfItemsInLine:n,direction:a,circularNavigation:o});for(;!i.isOutbound&&c.includes(i.nextIndex);)i=F({activeIndex:i.nextIndex,itemsCount:e,numberOfItemsInLine:n,direction:a,circularNavigation:o});return i}try{w.displayName="getActiveIndexFromInboundNavigation",w.__docgenInfo={description:"",displayName:"getActiveIndexFromInboundNavigation",props:{direction:{defaultValue:null,description:"",name:"direction",required:!0,type:{name:"NavDirections"}},numberOfItemsInLine:{defaultValue:null,description:"",name:"numberOfItemsInLine",required:!0,type:{name:"number"}},itemsCount:{defaultValue:null,description:"",name:"itemsCount",required:!0,type:{name:"number"}}}}}catch{}try{D.displayName="calcActiveIndexAfterArrowNavigation",D.__docgenInfo={description:"",displayName:"calcActiveIndexAfterArrowNavigation",props:{activeIndex:{defaultValue:null,description:"",name:"activeIndex",required:!0,type:{name:"number"}},itemsCount:{defaultValue:null,description:"",name:"itemsCount",required:!0,type:{name:"number"}},numberOfItemsInLine:{defaultValue:null,description:"",name:"numberOfItemsInLine",required:!0,type:{name:"number"}},direction:{defaultValue:null,description:"",name:"direction",required:!0,type:{name:"NavDirections"}},disabledIndexes:{defaultValue:{value:"[]"},description:"",name:"disabledIndexes",required:!1,type:{name:"number[]"}},circularNavigation:{defaultValue:{value:"false"},description:"",name:"circularNavigation",required:!1,type:{name:"boolean"}}}}}catch{}const N=-1;function L({ref:t,itemsCount:e,numberOfItemsInLine:n,onItemClicked:a,entryFocusStrategy:c="directional",getItemByIndex:o=m=>{},focusOnMount:i=!1,focusItemIndexOnMount:f=N,disabledIndexes:u=[],circularNavigation:s=!1}){const[m,v]=l.useState(i&&f!==N),E=l.useRef(!1),[p,g]=l.useState(m?f:N),[x,b]=l.useState(!0),h=l.useContext(S),C=d=>{if(b(!0),p===N){g(0);return}const{isOutbound:y,nextIndex:I}=D({activeIndex:p,itemsCount:e,numberOfItemsInLine:n,direction:d,disabledIndexes:u,circularNavigation:s});y?h==null||h.onOutboundNavigation(t,d):g(I)},U=l.useCallback(()=>{b(!0);const d=u.includes(0)&&u.length<e?Array.from({length:e},(y,I)=>I).find(y=>!u.includes(y))??0:0;g(d)},[u,e]),W=l.useCallback(()=>{b(!0);const d=u.includes(e-1)&&u.length<e?Array.from({length:e},(y,I)=>e-1-I).find(y=>!u.includes(y))??e-1:e-1;g(d)},[u,e]);l.useEffect(()=>{if(!E.current){E.current=!0;return}v(!1)},[p]);const P=l.useCallback(()=>{var d;return(d=t.current)==null?void 0:d.blur()},[t]),{lastNavigationDirectionRef:k}=K(),Y=l.useCallback(()=>{if(p!==N){b(!0);return}const d=k.current;g(c==="directional"&&d?w({direction:d,numberOfItemsInLine:n,itemsCount:e}):0),b(!0)},[p,c,e,k,n,g,b]),B=l.useCallback(()=>{b(!1)},[b]),$=l.useCallback(()=>{b(!0),g(N)},[g]);_({eventName:"focus",callback:Y,ref:t}),_({eventName:"mousedown",callback:B,ref:t}),_({eventName:"blur",callback:$,ref:t}),l.useEffect(()=>{var d;p>-1&&((d=t.current)==null||d.focus())},[p,t]);const T=l.useCallback((d,y=!1)=>{b(y),g(d),a(o(d),d)},[g,a,o]),X=l.useCallback(()=>{if(x)return T(p,!0)},[x,T,p]);return j({ref:t,onSelectionKey:X,onArrowNavigation:C,onEscape:P,onHome:U,onEnd:W,focusOnMount:i}),{activeIndex:x?p:N,onSelectionAction:T,isInitialActiveState:m}}try{L.displayName="useGridKeyboardNavigation",L.__docgenInfo={description:"A hook which is used for accessible keyboard navigation. Useful for components rendering a list of items that can be navigated and selected with a keyboard.",displayName:"useGridKeyboardNavigation",props:{ref:{defaultValue:null,description:"",name:"ref",required:!0,type:{name:"MutableRefObject<HTMLElement>"}},itemsCount:{defaultValue:null,description:"",name:"itemsCount",required:!0,type:{name:"number"}},numberOfItemsInLine:{defaultValue:null,description:"",name:"numberOfItemsInLine",required:!0,type:{name:"number"}},onItemClicked:{defaultValue:null,description:"",name:"onItemClicked",required:!0,type:{name:"(element: string | void | HTMLElement | ReactElement<any, string | JSXElementConstructor<any>>, index: number) => void"}},entryFocusStrategy:{defaultValue:{value:"directional"},description:"",name:"entryFocusStrategy",required:!1,type:{name:'"directional" | "first"'}},getItemByIndex:{defaultValue:{value:"(_index: number) => {}"},description:"",name:"getItemByIndex",required:!1,type:{name:"(index: number | void) => string | void | HTMLElement | ReactElement<any, string | JSXElementConstructor<any>>"}},focusOnMount:{defaultValue:{value:"false"},description:"",name:"focusOnMount",required:!1,type:{name:"boolean"}},focusItemIndexOnMount:{defaultValue:{value:"-1"},description:"",name:"focusItemIndexOnMount",required:!1,type:{name:"number"}},disabledIndexes:{defaultValue:{value:"[]"},description:"",name:"disabledIndexes",required:!1,type:{name:"number[]"}},circularNavigation:{defaultValue:{value:"false"},description:"",name:"circularNavigation",required:!1,type:{name:"boolean"}}}}}catch{}export{S as G,oe as a,K as b,L as u};
