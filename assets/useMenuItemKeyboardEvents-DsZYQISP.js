import{j as me}from"./jsx-runtime-lwGtIXvq.js";import{c as fe}from"./index-BpvXyOxN.js";import{r as l,R as N}from"./index-CTZeEbLr.js";import{u as pe}from"./useMergeRef-Do2VYePL.js";import{u as O}from"./useIsomorphicLayoutEffect-BBiFUoiz.js";import{u as I}from"./index-gB5zY9qh.js";import{k as v}from"./useClickableProps-CtaZWk7Q.js";import{N as K,b as be,A as ye,E as _e,H as Me,d as ve}from"./useFullKeyboardListeners-Bm0-g7hh.js";import{u as x}from"./index-BxdhJjph.js";import{g as ge}from"./typesciptCssModulesHelper-Ji7rRrZn.js";import{C as Ee,g as Ie,b as Ve}from"./test-ids-utils-BiWUJdxm.js";import{S as ae}from"./sizes-BOsbvv4u.js";import{c as ke}from"./index-B4QhyL3l.js";import{w as qe}from"./withStaticProps-DfSG2La2.js";import{u as te}from"./index-CkU0kzyk.js";function Ce(){const[e,t]=l.useState(null),a=typeof e=="number",r=l.useCallback((u,c)=>{t(c?u:null)},[t]),n=l.useCallback(()=>{t(null)},[t]);return{setSubMenuIsOpenByIndex:r,hasOpenSubMenu:a,openSubMenuIndex:e,setOpenSubMenuIndex:t,resetOpenSubMenuIndex:n}}function D({setActiveItemIndex:e,setOpenSubMenuIndex:t,onClose:a}){return l.useCallback((r={propagate:!1})=>{e(-1),t(null),a&&a(r)},[a,t,e])}try{D.displayName="useOnCloseMenu",D.__docgenInfo={description:"",displayName:"useOnCloseMenu",props:{setActiveItemIndex:{defaultValue:null,description:"",name:"setActiveItemIndex",required:!0,type:{name:"(index: number) => void"}},setOpenSubMenuIndex:{defaultValue:null,description:"",name:"setOpenSubMenuIndex",required:!0,type:{name:"(index: number) => void"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"(option: CloseMenuOption) => void"}}}}}catch{}const Se=[v.ESCAPE,v.LEFT_ARROW,v.TAB];function H({hasOpenSubMenu:e,onCloseMenu:t,ref:a,onClose:r,isSubMenu:n,useDocumentEventListeners:u}){const c=l.useCallback(o=>{const s=o.key;e||s===v.LEFT_ARROW&&!n||[v.ESCAPE,v.LEFT_ARROW,v.TAB].includes(s)&&(t({propagate:!1}),r&&(r({propagate:!1},s),o.preventDefault(),o.stopPropagation()))},[r,e,t,n]);I({keys:Se,callback:c,ref:u?void 0:a})}try{H.displayName="useCloseMenuOnKeyEvent",H.__docgenInfo={description:"",displayName:"useCloseMenuOnKeyEvent",props:{hasOpenSubMenu:{defaultValue:null,description:"",name:"hasOpenSubMenu",required:!0,type:{name:"boolean"}},onCloseMenu:{defaultValue:null,description:"",name:"onCloseMenu",required:!0,type:{name:"(option: CloseMenuOption) => void"}},ref:{defaultValue:null,description:"",name:"ref",required:!0,type:{name:"RefObject<HTMLElement>"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"(option: CloseMenuOption, key?: string) => void"}},isSubMenu:{defaultValue:null,description:"",name:"isSubMenu",required:!0,type:{name:"boolean"}},useDocumentEventListeners:{defaultValue:null,description:"",name:"useDocumentEventListeners",required:!0,type:{name:"boolean"}}}}}catch{}function L({hasOpenSubMenu:e,getNextSelectableIndex:t,getPreviousSelectableIndex:a,activeItemIndex:r,setActiveItemIndex:n,isVisible:u,ref:c,useDocumentEventListeners:o}){const s=l.useCallback(b=>{let _;if(e)return!1;b===K.DOWN?_=t(r):b===K.UP&&(_=a(r)),(_||_===0)&&n(_)},[r,t,a,e,n]),d=l.useCallback(()=>{s(K.UP)},[s]),p=l.useCallback(()=>{s(K.DOWN)},[s]),g=l.useCallback(b=>{u&&r===-1&&n(0)},[n,r,u]),y=l.useCallback(()=>{if(e)return;const b=t(-1);b!==-1&&n(b)},[e,t,n]),E=l.useCallback(()=>{if(e)return;const b=a(0);b!==-1&&n(b)},[e,a,n]),m=l.useMemo(()=>{if(!o)return{ref:c,preventDefault:!0,stopPropagation:!0}},[o,c]);I({keys:be,callback:p,...m}),I({keys:ye,callback:d,...m}),I({keys:_e,callback:g,...m}),I({keys:Me,callback:y,...m}),I({keys:ve,callback:E,...m})}try{L.displayName="useMenuKeyboardNavigation",L.__docgenInfo={description:"",displayName:"useMenuKeyboardNavigation",props:{hasOpenSubMenu:{defaultValue:null,description:"",name:"hasOpenSubMenu",required:!0,type:{name:"boolean"}},getNextSelectableIndex:{defaultValue:null,description:"",name:"getNextSelectableIndex",required:!0,type:{name:"(index: number) => number"}},getPreviousSelectableIndex:{defaultValue:null,description:"",name:"getPreviousSelectableIndex",required:!0,type:{name:"(index: number) => number"}},activeItemIndex:{defaultValue:null,description:"",name:"activeItemIndex",required:!0,type:{name:"number"}},setActiveItemIndex:{defaultValue:null,description:"",name:"setActiveItemIndex",required:!0,type:{name:"(index: number) => void"}},isVisible:{defaultValue:null,description:"",name:"isVisible",required:!0,type:{name:"boolean"}},ref:{defaultValue:null,description:"",name:"ref",required:!0,type:{name:"RefObject<HTMLElement>"}},useDocumentEventListeners:{defaultValue:null,description:"",name:"useDocumentEventListeners",required:!0,type:{name:"boolean"}}}}}catch{}function P({ref:e}){const[t,a]=l.useState(!1),r=l.useCallback(u=>{const c=e&&e.current,o=u.target===c;a(o)},[a,e]),n=l.useCallback(()=>a(!1),[a]);return te({eventName:"mouseenter",callback:r,ref:e}),te({eventName:"mouseleave",callback:n,ref:e}),t}function U({resetOpenSubMenuIndex:e,hasOpenSubMenu:t,ref:a,setActiveItemIndex:r}){const n=P({ref:a}),u=x(n);return O(()=>{n||n!==u&&(t||(e(),r(-1)))},[e,a,u,n,t,r]),n}try{U.displayName="useMouseLeave",U.__docgenInfo={description:"",displayName:"useMouseLeave",props:{resetOpenSubMenuIndex:{defaultValue:null,description:"",name:"resetOpenSubMenuIndex",required:!0,type:{name:"() => void"}},hasOpenSubMenu:{defaultValue:null,description:"",name:"hasOpenSubMenu",required:!0,type:{name:"boolean"}},ref:{defaultValue:null,description:"",name:"ref",required:!0,type:{name:"RefObject<HTMLElement>"}},setActiveItemIndex:{defaultValue:null,description:"",name:"setActiveItemIndex",required:!0,type:{name:"(index: number) => void"}}}}}catch{}function Y(e){return!!e.type.isSelectable&&!e.props.disabled}const Ne=(e,t,a)=>t.props.id||`${e}-item-${a}`,$=({children:e})=>{const t=l.useCallback(r=>{let n;for(let u=1;u<=e.length;u++)if(n=(r+u)%e.length,Y(e[n]))return n;return null},[e]),a=l.useCallback(r=>{let n;for(let u=e.length-1;u>0;u--)if(n=(r+u)%e.length,Y(e[n]))return n;return null},[e]);return{getNextSelectableIndex:t,getPreviousSelectableIndex:a}};try{$.displayName="useAdjacentSelectableMenuIndex",$.__docgenInfo={description:"",displayName:"useAdjacentSelectableMenuIndex",props:{}}}catch{}function Oe({onFocusWithin:e,onFocusWithinChange:t,isDisabled:a,onBlurWithin:r}){const n=l.useRef({isFocusWithin:!1}).current,u=l.useCallback(s=>{n.isFocusWithin||(e&&e(s),t&&t(!0),n.isFocusWithin=!0)},[e,t,n]),c=l.useCallback(s=>{const d=s.currentTarget;n.isFocusWithin&&!d.contains(s.relatedTarget)&&(r&&r(s),t&&t(!1),n.isFocusWithin=!1)},[r,t,n]),o=l.useMemo(()=>a?{focusWithinProps:{}}:{},[a]);return a?o:{focusWithinProps:{onFocus:u,onBlur:c}}}const W=({focusItemIndexOnMount:e,focusChildOnMount:t,getNextSelectableIndex:a,updateActiveItemIndex:r,setIsInitialFocusSet:n})=>{l.useEffect(()=>{if(e===-1)return;const u=Y(t)?e:a(e);u!==null&&requestAnimationFrame(()=>{r(u),n(!0)})},[t,e,a,n,r])};try{W.displayName="useFocusOnMount",W.__docgenInfo={description:"",displayName:"useFocusOnMount",props:{focusItemIndexOnMount:{defaultValue:null,description:"",name:"focusItemIndexOnMount",required:!0,type:{name:"number"}},focusChildOnMount:{defaultValue:null,description:"",name:"focusChildOnMount",required:!0,type:{name:"ReactElement<any, string | JSXElementConstructor<any>>"}},getNextSelectableIndex:{defaultValue:null,description:"",name:"getNextSelectableIndex",required:!0,type:{name:"(index: number) => number"}},updateActiveItemIndex:{defaultValue:null,description:"",name:"updateActiveItemIndex",required:!0,type:{name:"(index: number) => void"}},setIsInitialFocusSet:{defaultValue:null,description:"",name:"setIsInitialFocusSet",required:!0,type:{name:"(state: boolean) => void"}}}}}catch{}let Re=0;const he=()=>`menu-${Re++}`,z=e=>{const[t,a]=l.useState();return O(()=>{a(e||he())},[e]),t};try{z.displayName="useMenuId",z.__docgenInfo={description:"",displayName:"useMenuId",props:{}}}catch{}const Ae="_menu_10tj4_1",Te="_small_10tj4_11",Ke="_medium_10tj4_15",xe="_large_10tj4_19",ne={menu:Ae,small:Te,medium:Ke,large:xe},w=l.forwardRef(({id:e,className:t,size:a=ae.MEDIUM,tabIndex:r=0,ariaLabel:n="Menu",ariaDescribedBy:u,children:c,isVisible:o=!0,onClose:s,onItemFocus:d,focusOnMount:p=!1,focusItemIndex:g=-1,focusItemIndexOnMount:y=-1,isSubMenu:E=!1,useDocumentEventListeners:m=!1,shouldScrollMenu:b=!1,"data-testid":_},C)=>{const i=l.useRef(null),re=pe(i,C),R=z(e),ue=l.useRef(null),[h,le]=l.useState(g),[se,A]=l.useState(!1),V=l.useMemo(()=>N.Children.toArray(c).filter(M=>M.type.isMenuChild?!0:(console.error("Menu child must be a menuChild item (such as MenuItem, MenuDivider, MenuTitle, etc). This child is not supported: ",M),!1)),[c]),T=l.useCallback(f=>{var Q,B,ee;le(f);const M=V[f],Z=N.isValidElement(M)?((Q=M==null?void 0:M.props)==null?void 0:Q.id)||`${R}-item-${f}`:void 0;Z?(B=i==null?void 0:i.current)==null||B.setAttribute("aria-activedescendant",Z):(ee=i==null?void 0:i.current)==null||ee.removeAttribute("aria-activedescendant")},[V,R]),F=l.useCallback(f=>{d&&d(f),T(f),A(!1)},[T,d]),{setSubMenuIsOpenByIndex:oe,hasOpenSubMenu:k,openSubMenuIndex:ie,setOpenSubMenuIndex:ce,resetOpenSubMenuIndex:G}=Ce(),S=D({setActiveItemIndex:F,setOpenSubMenuIndex:ce,onClose:s});ke({ref:i,callback:()=>S()}),H({hasOpenSubMenu:k,onCloseMenu:S,ref:i,onClose:s,isSubMenu:E,useDocumentEventListeners:m});const{getNextSelectableIndex:j,getPreviousSelectableIndex:J}=$({children:V});L({hasOpenSubMenu:k,getNextSelectableIndex:j,getPreviousSelectableIndex:J,activeItemIndex:h,setActiveItemIndex:F,isVisible:o,ref:i,useDocumentEventListeners:m}),U({resetOpenSubMenuIndex:G,hasOpenSubMenu:k,ref:i,setActiveItemIndex:F}),W({focusItemIndexOnMount:y,focusChildOnMount:V[y],getNextSelectableIndex:j,updateActiveItemIndex:T,setIsInitialFocusSet:A});const de=l.useCallback(()=>{A(!0)},[A]),X=x(k);l.useEffect(()=>{var f;k||m||h>-1&&X&&((f=i==null?void 0:i.current)==null||f.focus())},[h,k,X,m]),O(()=>{!p||m||requestAnimationFrame(()=>{i&&i.current&&i.current.focus()})},[i,p,m]);const{focusWithinProps:q}=Oe({onBlurWithin:()=>{S&&S()}});return me.jsx("ul",{onFocus:q==null?void 0:q.onFocus,onBlur:q==null?void 0:q.onBlur,id:R,"data-testid":_||Ie(Ve.MENU,e),"data-vibe":Ee.MENU,className:fe(ne.menu,ge(ne,a),t),ref:re,tabIndex:r,"aria-label":n,role:"menu","aria-describedby":u,onMouseOver:de,children:V&&N.Children.map(V,(f,M)=>N.isValidElement(f)?N.cloneElement(f,{...f==null?void 0:f.props,activeItemIndex:h,index:M,setActiveItemIndex:T,menuRef:i,resetOpenSubMenuIndex:G,isParentMenuVisible:o,setSubMenuIsOpenByIndex:oe,hasOpenSubMenu:M===ie,closeMenu:S,id:Ne(R,f,M),useDocumentEventListeners:m,isInitialSelectedState:se,shouldScrollMenu:b,getNextSelectableIndex:j,getPreviousSelectableIndex:J,isUnderSubMenu:E,splitMenuItemIconButtonRef:ue}):null)})});Object.assign(w,{isMenu:!0,supportFocusOnMount:!0});const Qe=qe(w,{sizes:ae});try{w.displayName="Menu",w.__docgenInfo={description:"",displayName:"Menu",props:{size:{defaultValue:{value:"medium"},description:"Size of the menu.",name:"size",required:!1,type:{name:'"small" | "medium" | "large" | "xs" | "xxs"'}},tabIndex:{defaultValue:{value:"0"},description:"The tab index of the menu.",name:"tabIndex",required:!1,type:{name:"number"}},ariaLabel:{defaultValue:{value:"Menu"},description:"ARIA label for accessibility.",name:"ariaLabel",required:!1,type:{name:"string"}},ariaDescribedBy:{defaultValue:null,description:"ARIA description ID.",name:"ariaDescribedBy",required:!1,type:{name:"string"}},focusOnMount:{defaultValue:{value:"false"},description:"If true, the menu will automatically focus on mount.",name:"focusOnMount",required:!1,type:{name:"boolean"}},onItemFocus:{defaultValue:null,description:"Callback when a menu item gains focus.",name:"onItemFocus",required:!1,type:{name:"(index: number) => void"}},isVisible:{defaultValue:{value:"true"},description:"Controls the visibility of the menu.",name:"isVisible",required:!1,type:{name:"boolean"}},onClose:{defaultValue:null,description:"Callback triggered when the menu closes.",name:"onClose",required:!1,type:{name:"(option: CloseMenuOption) => void"}},focusItemIndex:{defaultValue:{value:"-1"},description:"Index of the focused menu item.",name:"focusItemIndex",required:!1,type:{name:"number"}},isSubMenu:{defaultValue:{value:"false"},description:"If true, this menu is a submenu.",name:"isSubMenu",required:!1,type:{name:"boolean"}},useDocumentEventListeners:{defaultValue:{value:"false"},description:"If true, event listeners will be attached to the document.",name:"useDocumentEventListeners",required:!1,type:{name:"boolean"}},focusItemIndexOnMount:{defaultValue:{value:"-1"},description:"Index of the item that should be focused when the menu mounts.",name:"focusItemIndexOnMount",required:!1,type:{name:"number"}},shouldScrollMenu:{defaultValue:{value:"false"},description:"If true, enables scrolling within the menu.",name:"shouldScrollMenu",required:!1,type:{name:"boolean"}},children:{defaultValue:null,description:"The menu items.",name:"children",required:!1,type:{name:"ElementContent"}},className:{defaultValue:null,description:"A CSS class name to apply to the component.",name:"className",required:!1,type:{name:"string"}},"data-testid":{defaultValue:null,description:"A unique identifier for testing purposes.",name:"data-testid",required:!1,type:{name:"string"}},id:{defaultValue:null,description:"An HTML id attribute for the component.",name:"id",required:!1,type:{name:"string"}}}}}catch{}function Be({ref:e,resetOpenSubMenuIndex:t,setSubMenuIsOpenByIndex:a,isActive:r,setActiveItemIndex:n,index:u,hasChildren:c,splitMenuItemIconButtonRef:o,splitMenuItem:s=!1}){const d=P({ref:e}),p=P({ref:o}),g=x(d),y=x(p);return O(()=>{p&&p!==y&&(r?a(u,!0):t())},[a,u,p,y,r,t]),O(()=>{if(d&&d!==g){if(!a||!t){console.error("MenuItem must be a first level child of a menu");return}t(),!r&&!s&&(n(u),c?a(u,!0):t()),r&&c&&a(u,!!d),!r&&s&&(n(u),p&&a(u,!0))}},[t,g,d,p,a,r,n,u,c,s]),d}const we=[v.ENTER,v.RIGHT_ARROW];function et({onClick:e,disabled:t,isActive:a,index:r,setActiveItemIndex:n,hasChildren:u,shouldShowSubMenu:c,setSubMenuIsOpenByIndex:o,menuRef:s,isMouseEnter:d,closeMenu:p,useDocumentEventListeners:g,splitMenuItem:y,isMouseEnterMenuItem:E,isMouseEnterIconButton:m}){const b=l.useCallback(_=>{if(!a&&!d)return;if(!n||!o){console.error("MenuItem must be a first level child of a menu");return}const C=_ instanceof KeyboardEvent;if(a&&u&&(n(r),!y||m)){o(r,!0);return}if(C&&y&&o(r,!0),c)return;const i=()=>{_.preventDefault(),e(_),p({propagate:!0})};if(C&&e&&!t&&a){if(_.key==="ArrowRight")return;i()}!C&&e&&!t&&d&&(a||(n(r),u&&o(r,!0)),(y&&E&&!m||!u)&&requestAnimationFrame(()=>{requestAnimationFrame(()=>{i()})}))},[a,d,n,o,u,y,c,e,t,r,p,E,m]);return I({keys:we,callback:b,ref:g?void 0:s}),{onClickCallback:b}}export{Qe as M,et as a,Oe as b,P as c,Be as u};
